\section*{Снова потоки}
\begin{enumerate}
	\item Разберитесь с пересчётом потенциалов при поиске потока.
	
	\textbf{Решение.}
	
	\item Дан массив, найдите $k$ непересекающихся возрастающих последовательностей максимальной длины за $O(kV^2)$.
	
	\textbf{Решение.}
	
	Построим сеть: каждому элементу массива $a[1..n]$ сопоставим вершину $v_i$. Рассмотрим элемент массива с 
	индексом $i$. Рассмотрим элементы с индексами $j = i + 1, i + 2, ..., n$. Если $a[i] < a[j]$, то добавим ребро 
	$v_i \to v_j$. Стоимость ребра установим в $-1$, а пропускную способность равную $1$. 
	
	Теперь добавим исток и сток. Добавим вершину $s = v_0$ - исток, соединим её со всеми $v_i, i = 1,..,n$ рёбрами 
	$v_0 \to v_i$ стоимости 0, пропускной способности $1$. Так же добавим вершину $t = v_{n + 1}$ - сток, добавим 
	ребра $v_i \to v_{n + 1}, i = 1,..,n$ стоимости $0$, пропускной способности $1$. Заметим, что теперь есть 
	проблема - через одну вершину может проходить несколько последовательностей. Чтобы это исправить, раздвоим 
	каждую вершину $v_i$ на $v_i$ и $v_i'$, и добавим ребро $v_i \to v_i'$ пропускной способности $1$. Ребра 
	входившие в $v_i$ входят в $v_i$, а ребра исходящие из $v_i$ теперь исходят только из $v_i'$.  
	
	Заметим, что все ребра в графе идут от вершин с меньшими номерами в вершины с большими номерами, значит циклов 
	отрицательного веса быть не может. Теперь, воспользовавшись результатом задачи $5$ с практики получим поток 
	минимального веса размера $k$ за $O(kn^2)$.

	
	\item Дан граф, на каждом ребре написано $2$ числа $L$ и $R$ и $c$. По каждому ребру может течь не более
	чем $R$, но не менее, чем $L$ жидкости. Найдите:
	\begin{enumerate}
		\item произвольную циркуляцию
		\item произвольный поток
		\item максимальный поток
		\item поток минимальной стоимости.
	\end{enumerate}
	
	\item Есть k одинаковых автоматов и n заданий. Про каждое задание известно, во сколько его нужно начать делать, 
	во сколько закончить, а также его стоимость. Каждый автомат может выполнять только одно задание в каждый момент 
	времени. Нужно выполнить задания максимальной суммарной стоимости. $O(kn \log n)$.
	
	\textbf{Решение.}
	
	Все задания задают два момента времени -- начало и конец задания, а также стоимости $c_i$. Каждому такому 
	моменту времени зададим вершину. Получится $2n$ вершин. Вершину соединим ребром с вершиной - соответствующим 
	следующему моменту времени (предварительно времена нужно отсортировать). Вес такого ребра сделаем равным $0$, 
	а пропускную способность $+\infty$. Добавили $2n - 1 = O(n)$ ребер. Теперь добавим ещё $n$ ребер. Для каждого 
	задания соединим вершину начала задания - с вершиной концом задания ребром пропускной способности $1$, 
	стоимости $-c_i$. Теперь осталось найти поток величины $k$ с минимальной стоимостью между вершиной начального 
	момента времени, и конечного момента времени. Т.к. граф ациклический - все ребра идут от меньшего момента 
	времени к большему, то отрицательных циклов быть не может. Значит, за $O(k)$ запусков алгоритм Дейкстры мы 
	сможем найти требуемый поток. 
	
	Сложность: $O(n\log n) + O(n) + O(kE\log V)$. Заметив, что $V = O(n), E = O(n)$. Получим итоговую оценку $O(kn\log n)$.
	
\end{enumerate}
