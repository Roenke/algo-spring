\section*{Линейное программирование}
\begin{enumerate}
	\item Сведите к задаче линейного программирования задачу:
	\begin{equation*}
		\min\limits_{1 \leqslant i \leqslant p} \left[ \sum\limits_{j = 1}^n c_{ij} x_j \right] \to \max
	\end{equation*}
	
	При ограничениях 
	\begin{align*}
		& \sum\limits_{j = 1}^n a_{ij} x_j = b_i, i \in [1..m] \\
		& x_i \geqslant 0, i \in [1..n]
	\end{align*}
	
	\textbf{Решение.}
	
	Немного преобразуем задачу. Введём новую переменную $y$. И выпишем для неё $p$ ограничений вида:
	\begin{align*}
		y &\leqslant \sum\limits_{j = 1}^nc_{1j}x_j \\
		y &\leqslant \sum\limits_{j = 1}^nc_{2j}x_j \\
		&\cdots\cdots \\
		y &\leqslant \sum\limits_{j = 1}^nc_{pj}x_j \\
	\end{align*}
	
	Теперь заметим, что для решения исходной задачи достаточно максимизировать $y$, объединив выписанные ограничения с уже имеющимися.
	\begin{equation*}
		y \to max
	\end{equation*}
	
	Ограничения те же, добавятся только ограничения для $y$, преобразованные к равенствам.
		
	\item Сведите к задаче линейного программирования задачу:
	\begin{equation*}
	\sum\limits_{i = 1}^p \left|\sum\limits_{j = 1}^n c_{ij}x_j - d_i\right| \to \min
	\end{equation*}
	
	При ограничениях 
	\begin{align*}
	& \sum\limits_{j = 1}^n a_{ij} x_j = b_i, i \in [1..m] \\
	& x_i \geqslant 0, i \in [1..n]
	\end{align*}
	
	\item Приведите пример несовместной задачи линейного программирования, двойственная к которой так же 
	несовместна.
	
	\textbf{Решение.} 
	
	Приведём в качестве примера двумерную задачу линейного программирования.
	
	Рассмотрим задачу:
	\begin{align*}
		a x_1 + b x_2 &\to \max \\
		x_1 + x_2 &\leqslant 2 \\
		-x_1 + x_2 &\leqslant -3\\
		x_1, x_2 &\geqslant 0
	\end{align*}
	
	Нетрудно заметить, что данная задача несовместна. Полуплоскости $y \leqslant 2 - x, y < x - 3$ не пересекаются в первом квадранте.
	
	Рассмотрим двойственную к ней задачу.
	\begin{align*}
		2 y_1 - 3y_2 &\to \min\\
		y_1 - y_2 &\geqslant a \\
		y_1 + y_2 &\geqslant b \\
		y_1, y_2 &\geqslant 0
	\end{align*}
	
	Осталось выбрать значения $a,b$, такие, что задача будет несовместной. Подойдут любые, такие, что $a > b$. Например, $a = 1, b = 2$
	
	\item Докажите, что если политоп линейной программы в канонической форме $(Ax = b, x \geqslant 0)$ целый для 
	любого вектора $b$, то матрица $A$ тотально унимодулярна.
	
	\textbf{Решение.}
	
	Это утверждение доказывается в статье \url{https://www.ifor.math.ethz.ch/teaching/lectures/integer_prog_ss10/chapter08} \textit{(Theorem 8.4 (Veinott \& Danzig (1968)))}
	
	Нужно лишь отметить, что условие для всех векторов $b$, значит, что и для всех целочисленных.
	
	\item Вспомним линейную программу для паросочетания в двудольном графе. Докажите, что для любого 
	недвудольного графа политоп заданный данной программой не будет целым.
	
	\textbf{Решение.}
	
	Заметим, что для решения данной задачи достаточно доказать утверждение о том, что матрица ограничений для 
	недвудольного графа не будет унимодулярной. Для этого достаточно привести минор в матрице, который не равен 
	$0, 1, -1$.
	
	Мы знаем, что если граф недвудольный, то в нем обязательно найдётся хотя бы один цикл нечётной длины. Найдём 
	такой цикл минимальной длины(для определённости возьмём минимальный, вообще можно любой), обозначим его $C$. 
	Преобразуем матрицу ограничений так, чтобы вершины и ребра входящие в цикл $C$ были в левом верхнем углу 
	матрицы, а вершины и ребра шли в порядке прохода по циклу(мы всегда можем менять местами строки со строками и 
	столбцы со столбцами, оставляя матрицу унимодулярной, т.к. могут поменяться только знаки миноров, что нас 
	утроит). 
	
	Тогда часть матрицы, которая соответствует циклу $C$, будет иметь вид:
	\begin{equation*}
		\begin{bmatrix}
		1 & 1 & 0 & 0 & \cdots & 0 & 0\\
		0 & 1 & 1 & 0 & \cdots & 0 & 0\\ 
		0 & 0 & 1 & 1 & \cdots & 0 & 0\\  
		\vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots\\
		0 & 0 & 0 & 0 & \cdots & 1 & 1 \\
		1 & 0 & 0 & 0 & \cdots & 0 & 1 \\
		\end{bmatrix}
	\end{equation*}
	
	Заметим, что разложив определитель этой матрицы по первому столбцу, получим, что он равен $2$. 
	
	Почему это так. При разложении по столбцу, нужно вычислить определители двух матриц меньшего размера. 
	Заметим, что они имеют треугольный вид, на их диагоналях стоят единицы $\Rightarrow$ их определители равны 1.
	
	Так же, заметим, что количество строк в матрице -- нечётное число, это значит, что знаки миноров меньшего 
	размера совпадают при разложении по первому столбцу (т.к. между ними нечётное число строк). Значит 
	определитель такой матрицы равен $1 + 1 = 2$. Эта матрица является минором исходной матрицы ограничений(либо 
	её можно им сделать), следовательно исходная матрица ограничений не унимодулярна.
	
	\item[*6.] Пусть у нас задан орграф $G = (V, E)$ с двумя выделенными различными вершинами $s, t \in V$ , для 
	каждого ребра $e$ которого задано вещественное неотрицательное число $c_e$ — его пропускная способность.
	
	$s-t$ потоком называется функция $f : E \to R^+$ такая, что:
	\begin{align*}
		\forall e \in E&: 0 \leqslant f_e \leqslant c_e \\
		\forall v \in V \setminus \{s, t\} &: \sum\limits_{e = (u,v)} f_e - \sum\limits_{e = (v,u)} f_e = 0
	\end{align*}
	
	Величиной потока называется:
	\begin{equation*}
		|f| = \sum\limits_{e = (s, u)} f_e - \sum\limits_{e = (u, s)} f_e
	\end{equation*}
	
	$s-t$ разрезом называется пара $(S, T = V \setminus S)$ подмножеств $V$ такая, что $s \in S$ и $t \in T$. 
	
	Весом разреза называется величина:
	\begin{equation*}
		\sum\limits_{e = u\in S, v\in T)} c_e
	\end{equation*}
	
	\begin{enumerate}
		\item Сведите задачу нахождения максимального $s-t$ потока к задаче линейного программирования.
		\item Пусть теперь граф $G$ будет \textbf{DAG}-ом, причем любая его вершина лежит на каком-то пути из $s$ 
		в $t$. Сведите задачу о минимальном $s-t$ разрезе к задаче линейного программирования.
		\item Сведите задачу о минимальном $s-t$ разрезе к задаче линейного программирования и покажите, что она 
		дуальна задаче о максимальном потоке, для произвольного неориентированного графа. Считайте, что 
		неориентированный граф это ориентированный граф, у которого для каждого ребра есть такое же в обратную 
		сторону.
		\item В произвольном орграфе сведите задачу о минимальном $s-t$ разрезе к задаче линейного 
		программирования и покажите, что она дуальна задаче о максимальном потоке.
	\end{enumerate}
\end{enumerate}



